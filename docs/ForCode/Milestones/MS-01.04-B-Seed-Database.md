# Milestone MS-01.04-B: Seed Database with Sample Data

## Framework: S-P-A-R-K

### Situation
We have created the database tables for `Event` and `Venue`, but they are empty. To build and test the UI components that display event schedules, we need realistic sample data in our database to work with. Manually inserting this data is tedious and not easily repeatable.

### Purpose
The goal is to create a TypeScript script that, when run, will automatically populate the database with a predefined set of venues and events. This ensures that every developer (and the AI assistant) can work with the same consistent dataset.

### Audience
This prompt is for an AI coding assistant being guided by a non-technical user. The instructions must be followed exactly.

### Roadmap
1.  Configure the `package.json` file to tell Prisma where to find the seed script.
2.  Create a new `seed.ts` file inside the `prisma` directory.
3.  Write the script using Prisma Client to create one venue (Mercedes-Benz Stadium) and two sample FIFA match events.
4.  Execute the seed script using a `pnpm` command.

### Knowledge
-   You will use the Prisma Client, an auto-generated database client, to write data to the database.
-   Seeding is a common development practice for creating a consistent database state.
-   The script will be a standard TypeScript file that imports the Prisma Client.

---

## Learning Outcomes

-   **Outcome 1**: Learn the standard Prisma workflow for seeding a database with initial data.
-   **Outcome 2**: Understand how to use the Prisma Client to programmatically create related records (an `Event` related to a `Venue`).
-   **Outcome 3**: Recognize the importance of having consistent, high-quality sample data for frontend development.

---

## Context from Source Docs

**Business Rationale (PRD)**: To build the "Event and Venue Discovery" feature, the frontend needs data to display. This script provides that data.
**WBS Alignment**: Phase 3 -> Task 3.5 (Event data ingestion). This simulates the result of a data ingestion process.
**Dependencies**: MS-01.04-A (Update Database Schema).
**Files to Create/Modify**:
-   `prisma/seed.ts` (new file)
-   `package.json`

**Acceptance Criteria**:
-   Running `pnpm prisma db seed` completes successfully without errors.
-   The `Venue` table in the database contains an entry for "Mercedes-Benz Stadium".
-   The `Event` table in the database contains at least two sample matches linked to the stadium.

---

## Guardrails

-   **Data Handling**: The seed script **must** use Prisma Client to ensure data integrity and type safety. Do not write raw SQL.
-   **Code Quality**: The script should be self-contained and exit gracefully upon completion.
-   **Security**: Do not include any real user data or sensitive information in the seed script.

---

## Implementation Checklist

-   [ ] **Task 1**: Configure the seed script path in `package.json`.
    -   **Action**: Open the `package.json` file and add the `prisma` key, like so:
    ```json
    {
      "name": "your-project-name",
      "version": "0.1.0",
      // ... other properties
      "prisma": {
        "seed": "ts-node --compiler-options '{\"module\":\"CommonJS\"}' prisma/seed.ts"
      },
      "scripts": {
        // ... your scripts
      },
      "dependencies": {
        // ... your dependencies
      },
      "devDependencies": {
        // ... your dev dependencies
      }
    }
    ```
    -   **Acceptance**: The `prisma` key is added to `package.json`.
-   [ ] **Task 2**: Install `ts-node` and `typescript` as dev dependencies.
    -   **Action**: Run this exact command in the terminal: `pnpm add -D ts-node typescript`
    -   **Acceptance**: The dependencies are added to `devDependencies` in `package.json`.
-   [ ] **Task 3**: Create the seed script.
    -   **Action**: Create a new file at `prisma/seed.ts`. Add the following code.
    ```ts
    import { PrismaClient } from '@prisma/client';

    const prisma = new PrismaClient();

    async function main() {
      console.log('Start seeding ...');

      // Create Mercedes-Benz Stadium
      const mbs = await prisma.venue.create({
        data: {
          name: 'Mercedes-Benz Stadium',
          address: '1 AMB Dr NW, Atlanta, GA 30313',
          latitude: 33.7555,
          longitude: -84.4008,
        },
      });
      console.log(`Created venue: ${mbs.name}`);

      // Create a couple of sample events
      await prisma.event.create({
        data: {
          fifaEventId: 'M01',
          name: 'Group Stage: USA vs. England',
          description: 'A thrilling group stage match.',
          startTime: new Date('2026-06-15T20:00:00Z'),
          venueId: mbs.id,
        },
      });
      console.log('Created event: USA vs. England');

      await prisma.event.create({
        data: {
          fifaEventId: 'M15',
          name: 'Round of 16: Brazil vs. Germany',
          description: 'A knockout stage clash between titans.',
          startTime: new Date('2026-06-28T19:00:00Z'),
          venueId: mbs.id,
        },
      });
      console.log('Created event: Brazil vs. Germany');

      console.log('Seeding finished.');
    }

    main()
      .catch((e) => {
        console.error(e);
        process.exit(1);
      })
      .finally(async () => {
        await prisma.$disconnect();
      });
    ```
    -   **Acceptance**: The file `prisma/seed.ts` is created with the specified content.
-   [ ] **Task 4**: Execute the seed script.
    -   **Action**: Run this exact command in the terminal: `pnpm prisma db seed`
    -   **Acceptance**: The command completes successfully, and you see the "Seeding finished." log message in your terminal.

---

## Testing Requirements

-   [ ] **Manual Verification**:
    1.  After the seed command finishes, run this command to open Prisma Studio (a visual database browser): `pnpm prisma studio`
    2.  A new tab will open in your browser.
    3.  Click on the `Venue` model on the left.
    4.  **Confirm**: You see one entry for "Mercedes-Benz Stadium".
    5.  Click on the `Event` model.
    6.  **Confirm**: You see two entries for the sample matches.
    7.  **Confirm**: The `venueId` for both events correctly corresponds to the ID of the stadium.

---

## Success Criteria

This milestone is complete when:
1.  The `pnpm prisma db seed` command executes without errors.
2.  The database is populated with one venue and two related events.
3.  The data can be viewed and verified using Prisma Studio.
4.  All acceptance criteria are met.
